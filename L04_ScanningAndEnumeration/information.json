{"description":"","goal":"<p>Learn scanning and enumeration techniques.</p>\n<p>First steps:&nbsp;</p>\n<p>open a terminal and run the following hack tools:&nbsp;</p>\n<p># Choose a root directory</p>\n<p>mkdir shared</p>\n<p><span id=\"docs-internal-guid-fa317d96-7fff-5d50-b62d-f0be15fa48d5\" style=\"box-sizing: border-box; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; vertical-align: baseline; white-space: pre-wrap;\">docker run -d -p 14500:14500 --restart unless-stopped -v ${PWD}/shared:/shared --name dsp_hacktool_wireshark --cap-add NET_ADMIN -e XPRA_PW=wireshark ffeldhaus/wireshark</span></p>\n<p>&nbsp;</p>\n<p dir=\"ltr\" style=\"box-sizing: border-box; margin: 0pt 0px; font-size: 16px; line-height: 1.38; padding-top: 20px; color: #333333; font-family: 'Open Sans', sans-serif;\"><span style=\"box-sizing: border-box; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; vertical-align: baseline; white-space: pre-wrap;\">docker run -d -it </span><span style=\"box-sizing: border-box; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; vertical-align: baseline; white-space: pre-wrap;\"><span id=\"docs-internal-guid-fa317d96-7fff-5d50-b62d-f0be15fa48d5\" style=\"box-sizing: border-box; font-size: 11pt; background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; vertical-align: baseline;\">--cap-add NET_ADMIN </span></span><span style=\"font-family: Arial; font-size: 14.6667px; white-space: pre-wrap; color: #000000;\">-v ${PWD}/shared:/shared </span><span style=\"background-color: transparent; color: #000000; font-family: Arial; font-size: 11pt; white-space: pre-wrap;\"> --name dsp_hacktool_kali dockersecplayground/kali:v1.2 /bin/bash </span></p>\n<p dir=\"ltr\" style=\"box-sizing: border-box; margin: 0pt 0px; font-size: 16px; line-height: 1.38; padding-top: 20px; color: #333333; font-family: 'Open Sans', sans-serif;\"><span style=\"background-color: transparent; color: #000000; font-family: Arial; font-size: 11pt; white-space: pre-wrap;\">Attach kali to the network by pressing Attach button. </span></p>\n<p><span style=\"box-sizing: border-box; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; vertical-align: baseline; white-space: pre-wrap;\">Now use firefox to open wireshark: </span></p>\n<p><a href=\"https://localhost:14500/?username=wireshark=password=wireshark&amp;sharing=true%E2%80%A8%20\">https://localhost:14500/?username=wireshark=password=wireshark&amp;sharing=true</a>&nbsp;&nbsp;</p>\n<p>Open two kali terminals by using the hack tools tab.</p>\n<p>In the first terminal run tcpdump inside the /shared directory:&nbsp;</p>\n<p>cd /shared</p>\n<p>tcpdump -i eth2 -s 65535 -w &lt;namefile&gt;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p class=\"p1\">Your goals are:&nbsp;</p>\n<ul>\n<li>Find all alive machines by using arp and icmp techniques</li>\n<li>Scan the network to detect running services</li>\n<li>Analyze the traffic acquired with tcpdump by using wireshark</li>\n</ul>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<div id=\"gtx-trans\" style=\"position: absolute; left: 600px; top: 340.594px;\">&nbsp;</div>","solution":"<p>Ifconfig to detect interface:&nbsp;</p>\n<p>eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet eth1 netmask 255.255.0.0 broadcast 172.18.255.255 ether 02:42:ac:12:00:06 txqueuelen 0 (Ethernet) RX packets 12 bytes 928 (928.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 loop txqueuelen 1 (Local Loopback) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0root@a5c15dda0993:/#</p>\n<p>&nbsp;</p>\n<p>Set wireshark:&nbsp;</p>\n<p>root@a5c15dda0993:/shared# cd /shared/root@a5c15dda0993:/shared# tcpdump -i eth1 -s 65535 -w dumping_arp.txt tcpdump: listening on eth1, link-type EN10MB (Ethernet), capture size 65535 bytes</p>\n<p>&nbsp;</p>\n<p>Run arp-scan</p>\n<p>root@a5c15dda0993:/# arp-scan --interface=eth1 172.18.0.0/24Interface: eth1, datalink type: EN10MB (Ethernet)Starting arp-scan 1.9.5 with 256 hosts (https://github.com/royhills/arp-scan)172.18.0.1 02:42:b0:35:47:2b (Unknown)172.18.0.2 02:42:ac:12:00:02 (Unknown)172.18.0.3 02:42:ac:12:00:03 (Unknown)172.18.0.4 02:42:ac:12:00:04 (Unknown)172.18.0.5 02:42:ac:12:00:05 (Unknown)5 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.9.5: 256 hosts scanned in 3.143 seconds (81.45 hosts/sec). 5 respondedroot@a5c15dda0993:/#</p>\n<p>&nbsp;</p>\n<p>You have found alive machines.&nbsp;</p>\n<p>Close tcpdump and&nbsp;analyzes the packets by using wireshark.</p>\n<p>&nbsp;</p>\n<p><img src=\"https://github.com/NS-unina/DSP_Repo/blob/master/.docker-images/scanning_enumeration/dumping_arp_1.png?raw=true\" alt=\"\" width=\"2260\" height=\"1198\" /></p>\n<p>&nbsp;</p>\n<p>Look at arp requests.</p>\n<p>Only alives machines answers with arp reply.</p>\n<p><img src=\"https://github.com/NS-unina/DSP_Repo/blob/master/.docker-images/scanning_enumeration/dumping_arp_2.png?raw=true\" alt=\"\" width=\"1924\" height=\"280\" /></p>\n<p>You can see that an high number of arp packets in the subnet.</p>\n<p>&nbsp;</p>\n<p>Retry the experiment by using fping.&nbsp;<br />You can see icmp packets.&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p><strong>Scanning&nbsp;&nbsp;</strong></p>\n<p>Save the alive ips in a file:&nbsp;</p>\n<p>root@a5c15dda0993:/shared# tcpdump -i eth1 -s 65535 -w dumping_nmap.txttcpdump: listening on eth1, link-type EN10MB (Ethernet), capture size 65535 bytes</p>\n<p>&nbsp;</p>\n<p>root@a5c15dda0993:/# cat ips.txt 172.18.0.2 172.18.0.3 172.18.0.4 172.18.0.5 root@a5c15dda0993:/# nmap -iL ips.txtStarting Nmap 7.60 ( https://nmap.org ) at 2019-10-09 20:46 UTC</p>\n<p>&nbsp;</p>\n<p>Nmap scan report for l04_scanningandenumeration_eye_container_1.l04_scanningandenumeration_default (172.18.0.2)Host is up (0.00025s latency).All 1000 scanned ports on l04_scanningandenumeration_eye_container_1.l04_scanningandenumeration_default (172.18.0.2) are closedMAC Address: 02:42:AC:12:00:02 (Unknown)Nmap scan report for l04_scanningandenumeration_ftp_1.l04_scanningandenumeration_default (172.18.0.3)Host is up (0.00016s latency).All 1000 scanned ports on l04_scanningandenumeration_ftp_1.l04_scanningandenumeration_default (172.18.0.3) are closedMAC Address: 02:42:AC:12:00:03 (Unknown)Nmap scan report for l04_scanningandenumeration_telnet_1.l04_scanningandenumeration_default (172.18.0.4)Host is up (0.000094s latency).Not shown: 999 closed portsPORT STATE SERVICE23/tcp open telnetMAC Address: 02:42:AC:12:00:04 (Unknown)Nmap scan report for l04_scanningandenumeration_samba_1.l04_scanningandenumeration_default (172.18.0.5)Host is up (0.00012s latency).Not shown: 998 closed portsPORT STATE SERVICE139/tcp open netbios-ssn445/tcp open microsoft-dsMAC Address: 02:42:AC:12:00:05 (Unknown)</p>\n<p>&nbsp;</p>\n<p>Inspect the packets with wireshark.</p>\n<p>You can use wireshark filters to see 3-way handshaking for running services.&nbsp;</p>\n<p><img src=\"https://github.com/NS-unina/DSP_Repo/blob/master/.docker-images/scanning_enumeration/wireshark_nmap.png?raw=true\" alt=\"\" width=\"2008\" height=\"583\" /></p>\n<p>But now .... open Network Elements and go inside iplog:&nbsp;</p>\n<p>tail the following file:&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;<span style=\"background-color: #101010; color: #f0f0f0; font-family: 'DejaVu Sans Mono', 'Everson Mono', FreeMono, Menlo, Terminal, monospace; font-size: 15px; white-space: pre;\">root@b9d215f07aa4:/iplog# tail -f /iplog.log </span></p>\n<p>Oct 9 20:57:17 TCP: to port 1025 from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to microsoft-ds from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to telnet from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to ftp from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to mysql from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to domain from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to netbios-ssn from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to port 8888 from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: to port 3389 from dsp_hacktool_kali.l04_scanningandenumeration_default:46997Oct 9 20:57:17 TCP: SYN scan detected [ports 1025,445,23,21,3306,53,139,8888,3389,199,...] from dsp_hacktool_kali.l04_scanningandenumeration_default [port 46997]tail: unrecognized file system type 0x794c7630 for '/iplog.log'. please report this to bug-coreutils@gnu.org. reverting to polling</p>\n<p>&nbsp;</p>\n<p>All your activities has been logged by iplog, a network logger!&nbsp;</p>\n<p>Be careful when you try to do these activities, you should <strong>always</strong> be authorized... or you can use DSP ;)&nbsp;</p>\n<p>&nbsp;</p>","author":"dsp"}
