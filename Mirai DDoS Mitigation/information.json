{"description":"Use a distributed defense infrastructure to monitor and redirect a DDoS attack","goal":"","solution":"<p>Access Fastnetmon container and run the application:</p>\n<p style=\"padding-left: 30px;\">$ /opt/fastnetmon/fastnetmon &amp; /opt/fastnetmon/fastnetmon_client</p>\n<p>&nbsp;</p>\n<p>Start exabgp with the following command:</p>\n<p style=\"padding-left: 30px;\">$ env exabgp.daemon.user=root exabgp.daemon.daemonize=true exabgp.daemon.pid=/var/run/exabgp.pid exabgp.log.destination=/var/log/exabgp.log exabgp /etc/exabgp/exabgp_blackhole.conf</p>\n<p>&nbsp;</p>\n<p>By default, it will announce a route to the target network.</p>\n<p>You can check this out in the quagga container, running the following commands:</p>\n<p style=\"padding-left: 30px;\">$&nbsp; <span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">vtysh</span> <span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span> <span class=\"crayon-v\">bgpd</span> <span class=\"crayon-o\">-</span><span class=\"crayon-i\">c</span> <span class=\"crayon-s\">\"show ip bgp summary\"</span></p>\n<p style=\"padding-left: 30px;\"><span class=\"crayon-s\">$&nbsp; <span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">vtysh</span> <span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span> <span class=\"crayon-v\">bgpd</span> <span class=\"crayon-o\">-</span><span class=\"crayon-i\">c</span> <span class=\"crayon-s\">\"show ip bgp\"</span></span></p>\n<p style=\"padding-left: 30px;\">&nbsp;</p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">Now connect to the C&amp;C server of the Mirai Botnet (you can do this from a terminal on your localhost, or by attaching a telnet Hack Tool)</span></span></p>\n<p style=\"padding-left: 30px;\"><span class=\"crayon-s\"><span class=\"crayon-s\">$ telnet 172.22.0.3</span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">Launch the attack</span></span></p>\n<p style=\"padding-left: 30px;\"><span class=\"crayon-s\"><span class=\"crayon-s\">$ syn 172.20.0.3 180</span></span></p>\n<p>&nbsp;</p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">Check the fastnetmon client, you will notice some incoming traffic towards the target network.</span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">Now go on the exabgp container and stop the running process.</span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">Modify the stati route that exabgp is announcing.</span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">You can do this either from terminal:</span></span></p>\n<p style=\"padding-left: 30px;\"><span class=\"crayon-s\"><span class=\"crayon-s\">$ vim /etc/exabgp/exabgp_blackhole.conf</span></span></p>\n<p style=\"padding-left: 30px;\"><span class=\"crayon-s\"><span class=\"crayon-s\">and change the static route from 172.20.0.0/24 to 10.10.10.1/24,</span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">or you can directly access the exabgp_blackhole.conf inside the exabgp folder of the current lab. That way you can modify the file with your favourite editor.</span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">After modified the configuration file, restart the exabgp process</span></span></p>\n<p style=\"padding-left: 30px;\"><span class=\"crayon-s\"><span class=\"crayon-s\">$ env exabgp.daemon.user=root exabgp.daemon.daemonize=true exabgp.daemon.pid=/var/run/exabgp.pid exabgp.log.destination=/var/log/exabgp.log exabgp /etc/exabgp/exabgp_blackhole.conf</span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\">You can check again the quagga router configuration and notice a new route announced:</span></span></p>\n<p style=\"padding-left: 30px;\"><span class=\"crayon-s\"><span class=\"crayon-s\"><span class=\"crayon-s\">$&nbsp; <span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">vtysh</span> <span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span> <span class=\"crayon-v\">bgpd</span> <span class=\"crayon-o\">-</span><span class=\"crayon-i\">c</span> <span class=\"crayon-s\">\"show ip bgp\"</span></span></span></span></p>\n<p><span class=\"crayon-s\"><span class=\"crayon-s\"><span class=\"crayon-s\"><span class=\"crayon-s\">Now you can try performing another mirai attack, but you won't see any incoming traffic in your fastnetmon client screen.</span></span></span></span></p>\n<p>&nbsp;</p>","author":"efrcatu"}
